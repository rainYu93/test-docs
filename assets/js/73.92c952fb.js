(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{475:function(t,s,a){"use strict";a.r(s);var r=a(56),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[t._v("#")]),t._v(" 1 概述")]),t._v(" "),a("h3",{attrs:{id:"_1-1-文档概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-文档概述"}},[t._v("#")]),t._v(" 1.1 文档概述")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("概述")]),t._v(" "),a("p",[t._v("1.27.0及之后版本微服务拆分（公有云开发版本2022/04/18投入使用），工作流审批表单开发及配置模式变动较大，此文档说明。")])]),t._v(" "),a("h2",{attrs:{id:"_2-工作流表单开发配置说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-工作流表单开发配置说明"}},[t._v("#")]),t._v(" 2 工作流表单开发配置说明")]),t._v(" "),a("h3",{attrs:{id:"_2-1-标准审批表单开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-标准审批表单开发"}},[t._v("#")]),t._v(" 2.1 标准审批表单开发")]),t._v(" "),a("p",[a("a",{attrs:{href:"/course/workFlowDevelopTemplate"}},[t._v("点击跳转详细代码示例")])]),t._v(" "),a("h4",{attrs:{id:"标准审批表单-建议开发步骤如下。"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#标准审批表单-建议开发步骤如下。"}},[t._v("#")]),t._v(" 标准审批表单，建议开发步骤如下。")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("在项目中找到路径 src/components/Workflow/ , 在该路径名称新建一个文件夹如 TemplateApproval(文件夹用大驼峰命名)。")])]),t._v(" "),a("li",[a("p",[t._v("在 TemplateApproval 目录下建立如下目录")])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("目录")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("api")]),t._v(" "),a("td",[t._v("与后端交互接口定义")])]),t._v(" "),a("tr",[a("td",[t._v("components")]),t._v(" "),a("td",[t._v("当前审批私有化组件（一般不具有通用性）")])]),t._v(" "),a("tr",[a("td",[t._v("datasource")]),t._v(" "),a("td",[t._v("数据操作对象目录")])]),t._v(" "),a("tr",[a("td",[t._v("TemplateApprovalFrom.vue")]),t._v(" "),a("td",[t._v("审批表单入口界面")])])])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("开发完成后,获取审批表单绝对路径./src/components/Workflow/TemplateApproval/TemplateApprovalFrom.vue,并将组件通过\nremoteConfig.js曝露出去,如下示例代码。获取当前服务联邦模式对外曝露的服务名（如vue.config.js图示）及当前曝露的组件名称构造成完整表单地址；eg：/appPlat/TemplateApprovalFrom，\n后续在流程表单移动端url处进行配置。")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n    * 组件曝露\n    * @type {{}}\n      */")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exposes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"./TemplateApprovalFrom"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./src/components/Workflow/TemplateApproval/TemplateApprovalFrom.vue"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("vue.config.js图：")]),t._v(" "),a("img",{staticClass:"img-style",attrs:{src:t.$withBase("/assets/img/document/vueConfig.png")}}),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v('各业务服务线下运行并无"审批工作台"子应用，若要验证可修改dynamic.js验证表单地址进行本地开发验证，如下示例。')])]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" applications "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('/**\n      * 审批表单验证，我们为您提供工作流表单验证界面，审批工作台可能不在当前服务\n      * 如果验证开发的审批表单是否正常，可替换mobileFormUrl为当前开发的工作流审批表单路径，\n      * 若当前界面验证正常，审批工作台可正常展示，开发完成后将mobileFormUrl组件通过remoteConfig.js曝露\n      * 出去供审批工作台服务调用即可\n      * eg：当前例子曝漏出去的配置为"./OrderApproval":"./src/components/Workflow/OrderApprovalFormNew/OrderApproval.vue"\n      * 工作流表单配置，移动端url配置则为/appCpra/OrderApprovalFormNew?poHeaderId=${poHeaderId}\n      * appCpra(请使用对应服务联邦模式简称，当前以协同为例，勿直接copy)\n        */')]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"审批表单验证"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("route")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("ApprovalFormVerify?mobileFormUrl=")]),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeURIComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/OrderApprovalFormNew/OrderApproval?poHeaderId=3271657791136"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[a("p",[t._v("表单页面开发中，使用 "),a("code",[t._v('this.$emit("GetApprovalTitle","标题"）')]),t._v("设置当前工作流详情页的顶部标题，使用 "),a("code",[t._v('this.$emit("GetAttachmentUuid", attachmentUuid)')]),t._v("\n设置工作流详情页导航栏的附件。")])]),t._v(" "),a("li",[a("p",[t._v("在dev开发测试完成后，后面不管是提测还是发版上线，都需提交种子数据同步申请。")])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-审批表单配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-审批表单配置"}},[t._v("#")]),t._v(" 2.2 审批表单配置")]),t._v(" "),a("ol",[a("li",[a("p",[t._v('审批表单的配置同pc一致，找到对应流程单据或新建流程单据，如下图所示。将步骤2.1获取的审批表单地址填至"移动端表单URL"处，URl参数使用?\n拼接在链接后，多个参数使用&分割，使用的参数和pc保持一致，若"PC端表单URL"未配置，可与对应审批开发的后端技术沟通所需参数。\n'),a("img",{staticClass:"img-style",attrs:{src:t.$withBase("/assets/img/document/流程表单(新).png")}})])]),t._v(" "),a("li",[a("p",[t._v('登陆线上服务，进入"审批工作台"子应用，点击对应单据，若成功载入审批表单，则可正常使用。如果未成功加载，查看接口 '),a("code",[t._v("getMobileFormUrl")]),t._v(" 返回字段是为刚刚配置的路径，\n若未返回，联系后端技术查看原因；若返回正常配置未加载成功，查看remoteConfig.js配置是否正常或者开发的代码是否已经进行线上部署。若以上操作都无法解决，联系移动平台技术进行协助查看。")])])]),t._v(" "),a("img",{staticClass:"img-style",attrs:{src:t.$withBase("/assets/img/document/返回mobileFormUrl(新).png")}}),t._v(" "),a("h3",{attrs:{id:"_2-3-标准二开审批表单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-标准二开审批表单"}},[t._v("#")]),t._v(" 2.3 标准二开审批表单")]),t._v(" "),a("p",[t._v("目前移动工作流表单支持个性化，如果通过个性化配置即可实现，配置即可；如果需要进行开发，二开代码需新建在src/components/Workflow/CUX/目录下，\n文件夹名称同标准一致，eg：src/components/Workflow/CUX/TemplateApproval,审批表单入口界面名称使用租户简称作为前缀，eg:BJT_TemplateApprovalFrom.Vue；\n所有基于当前这个标准审批二开的表单都存放在当前目录，所以其目录可能有BJT_TemplateApprovalFrom.vue,YHL_TemplateApprovalFrom.vue等多个二开表单入口界面。\n其他开发及配置与标准相同。"),a("strong",[t._v("1.27.0及之后版本微服务拆分，微服务拆分后的srm-front-app-cux二开服务无需此目录， 本就是二开服务")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"_2-4-其它"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-其它"}},[t._v("#")]),t._v(" 2.4 其它")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("💁\n可复用子应用详情页为审批表单;当前开发的审批表单对应的pc功能未来会标准化为移动端子应用，或者已经存在对应的子应用，可直接将子应用详情页作为组件曝露出去；\n当前详情页接收的参数务必要兼容两种情况，props组件传参，router路由传参数。")])]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("警告")]),t._v(" "),a("p",[t._v("标准的请使用平台账号配置预定义审批表单，二开的请使用租户管理员账号配置审批表单;不轻易修改已经配置好的工作流路径。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);